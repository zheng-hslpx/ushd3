{
  "env_paras": {
    "num_usvs": 5,
    "num_tasks": 24,
    "map_size": [120, 120],
    "battery_capacity": 220.0,
    "usv_speed": 5.0,
    "charge_time": 30.0,
    "device": "cuda:0",
    "min_task_time_visual": 5.0,
    "reward_config": {
      "use_potential_based_reward": false,
      "makespan_normalization": 200.0,
      "_comment_enhanced_weights": "*** 增强版奖励权重 - 基于第5次成功经验微调 ***",
      "w_progress": 2.25,
      "w_distance": 0.4,
      "w_balance": 0.8,
      "w_efficiency": 0.4,
      "w_timing": 0.8,
      "w_final_balance": 7.0,
      "w_step_efficiency": 0.3,
      "w_variance": 0.2,
      "_comment_refined_weights": "*** 精调权重 - 争取reward转正 ***",
      "w_makespan_improvement": 0.7,
      "w_makespan_penalty": 0.2,
      "baseline_reward": 51
    },
    "dynamic_masking_config": {
      "enabled": true,
      "max_load_ratio": 1.3
    }
  },
  "model_paras": {
    "embedding_dim": 64,
    "_comment_enhanced_architecture": "*** 增强版网络架构参数 ***",
    "num_heads": 1,
    "num_attention_heads": 4,
    "num_hgnn_layers": 3,
    "eta_neighbors": 3,
    "mlp_hidden_dim": 128,
    "_comment_increased_capacity": "*** 增加网络容量 ***",
    "n_hidden_actor": 3,
    "n_hidden_critic": 5,
    "n_latent_actor": 128,
    "n_latent_critic": 256,
    "dropout": 0.15,
    "device": "cuda:0",

    "_comment_new_features": "*** 新增网络特性 ***",
    "use_batch_norm": true,            
    "critic_layer_sizes": [256, 256, 128]  
  },
  "train_paras": {
    "_comment_enhanced_training": "*** 增强版训练策略 ***",
    "lr": 2e-4,
    "betas": [0.9, 0.999],
    "gamma": 0.99,
    "gae_lambda": 0.95,
    "K_epochs": 4,
    "eps_clip": 0.15,
    "A_coeff": 1.0,
    "vf_coeff": 0.3,
    "entropy_coeff": 0.02,
    "max_grad_norm": 0.5,

    "_comment_learning_rate_enhancements": "*** 学习率增强策略 ***",
    "warmup_steps": 100,               
    "lr_decay_patience": 50,           
    "min_lr": 5e-7,                    

    "early_stop_patience": 150,
    "max_episodes": 1000,
    "minibatch_size": 64,
    "save_frequency": 80,
    "eval_frequency": 20,
    "report_root": "results/reports",
    "report_episodes": 50,
    "viz": true,
    "viz_name": "USV_HGNN_PPO_V7_Final",
    "save_root": "results/saved_models",
    "save_only_last": false,
    "run_name": "Final_Push_5x24_v7",
    "_comment_new_features": "*** 新功能配置 ***",
    "debug_mode": false,
    "gradient_monitoring": true,
    "adaptive_lr": true,
    "use_lr_warmup": true,             
    "enhanced_critic": true            
  }
}